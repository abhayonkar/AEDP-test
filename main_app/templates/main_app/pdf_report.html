<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AEDP Report for {{ user_data.username }}</title>
    <style>
        @page { size: A4 landscape; margin: 1cm; }
        body { font-family: sans-serif; color: #333; font-size: 10pt; }
        h1 { color: #1f3c72; text-align: center; border-bottom: 2px solid #1f3c72; padding-bottom: 10px; }
        h2 { color: #1f3c72; border-bottom: 1px solid #ccc; padding-bottom: 5px; margin-top: 20px; page-break-before: auto; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { border: 1px solid #ddd; padding: 5px; text-align: left; word-wrap: break-word; }
        th { background-color: #1f3c72; color: white; font-size: 9pt; }
        .section { page-break-inside: avoid; }
        .no-data { color: #888; font-style: italic; }
        .header-info { text-align: center; margin-bottom: 20px; }
        tfoot { font-weight: bold; }
    </style>
</head>
<body>
    <h1>AEDP Implementation Status & Way Forward</h1>
    <div class="header-info">
        <h3>Report for: {{ user_data.get_full_name|default:user_data.username }}</h3>
        {% if basic_info %}
            <p><strong>University:</strong> {{ basic_info.university_name }} | <strong>PVC:</strong> {{ basic_info.pvc_name }} | <strong>Date:</strong> {{ basic_info.report_date|date:"F j, Y" }} | <strong>Academic Year:</strong> {{ basic_info.academic_year }}</p>
        {% endif %}
    </div>

    <div class="section">
        <h2>Industry Engagement & MoUs</h2>
        {% if industry_data %}
            <table>
                <thead>
                    <tr>
                        <th>Industry Name</th>
                        <th>Sector</th>
                        <th>MoU</th>
                        <th>Start Date</th>
                        <th>Validity Date</th>
                        <th>Student Commitment</th>
                        <th>Stipend Range</th>
                        <th>Engagement</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in industry_data %}
                    <tr>
                        <td>{{ item.industry_name }}</td>
                        <td>{{ item.sector_name }}</td>
                        <td>{{ item.mou_signed }}</td>
                        <td>{{ item.start_date|default:"N/A" }}</td>
                        <td>{{ item.validity_date|default:"N/A" }}</td>
                        <td>{{ item.student_commitment }}</td>
                        <td>{{ item.stipend_range|default:"N/A" }}</td>
                        <td>{{ item.type_of_engagement }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="5">Total Student Commitment</td>
                        <td colspan="3">{{ total_student_commitment }}</td>
                    </tr>
                </tfoot>
            </table>
        {% else %}<p class="no-data">No data available.</p>{% endif %}
    </div>

    <div class="section">
        <h2>Sector Skill Council (SSC) Engagement & MoU</h2>
        {% if ssc_data %}
            <table>
                <thead>
                    <tr>
                        <th>SSC Name</th>
                        <th>Sector</th>
                        <th>MoU</th>
                        <th>Start Date</th>
                        <th>Validity Date</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in ssc_data %}
                    <tr>
                        <td>{{ item.ssc_name }}</td>
                        <td>{{ item.sector_name }}</td>
                        <td>{{ item.mou_signed }}</td>
                        <td>{{ item.start_date|default:"N/A" }}</td>
                        <td>{{ item.validity_date|default:"N/A" }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}<p class="no-data">No data available.</p>{% endif %}
    </div>

    <div class="section">
        <h2>BOAT Collaboration</h2>
        {% if boat_data %}
            <table>
                <thead>
                    <tr>
                        <th>AEDP Programme</th>
                        <th>No. of Students</th>
                        <th>Stipend</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in boat_data %}
                    <tr>
                        <td>{{ item.aedp_programme }}</td>
                        <td>{{ item.no_of_students }}</td>
                        <td>{{ item.stipend|default:"N/A" }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
                <tfoot>
                    <tr>
                        <td>Total Students</td>
                        <td colspan="2">{{ total_boat_students }}</td>
                    </tr>
                </tfoot>
            </table>
        {% else %}<p class="no-data">No data available.</p>{% endif %}
    </div>

    <div class="section">
        <h2>Implementation Progress of Selected AEDP Program</h2>
        {% if program_data %}
            <table>
                <thead>
                    <tr>
                        <th>Program Name</th>
                        <th>Syllabus Prep.</th>
                        <th>Credit Alloc.</th>
                        <th>Deans Approval</th>
                        <th>Council Approval</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in program_data %}
                    <tr>
                        <td>{{ item.program_name }}</td>
                        <td>{{ item.syllabus_preparation }}</td>
                        <td>{{ item.credit_allocation }}</td>
                        <td>{{ item.board_of_deans_approval }}</td>
                        <td>{{ item.academic_council_approval }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}<p class="no-data">No data available.</p>{% endif %}
    </div>

    <div class="section">
        <h2>AEDP Program Readiness: University Campus & College Details</h2>
        {% if campus_data %}
            <table>
                <thead>
                    <tr>
                        <th>Campus/College</th>
                        <th>Programme</th>
                        <th>Duration</th>
                        <th>Intake</th>
                        <th>Enrolled</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in campus_data %}
                    <tr>
                        <td>{{ item.campus_college_name }}</td>
                        <td>{{ item.aedp_programme }}</td>
                        <td>{{ item.duration }}</td>
                        <td>{{ item.student_intake }}</td>
                        <td>{{ item.student_enrolled }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="4">Total Enrolled Students</td>
                        <td>{{ total_enrolled_students }}</td>
                    </tr>
                </tfoot>
            </table>
        {% else %}<p class="no-data">No data available.</p>{% endif %}
    </div>

    <div class="section">
        <h2>Challenges & Risk Mitigation Strategy</h2>
        <p>{{ challenges.content|linebreaksbr|default:"No challenges specified." }}</p>
    </div>

</body>
</html>